---
title: '[學習之路] JS 前端框架 React - 初階'
categories:
  - Zero Road
  - Web Fronted
tag:
  - ReactJS
  - JavaScript
date: 2021-10-19 13:09:14
---
![](https://i.imgur.com/iWnyS9n.png)
React 是由 Facebook 所主導開發的 JavaScript 框架，與 AngularJS 相同都是採用組件 Componet-based 來進行觀念導向設計，不像 VueJS 採用 MVVM（Model 資料管理、View 畫面顯示、ViewModal 溝通橋梁）觀念去區分細節，而是整個融合在 Componet 整個零件內。

<!-- more -->

# React
React 的官方教學其實十分完善充裕並提供中文，本篇內容將跟隨官方的手冊摸索進行學習，正式介紹前以下有幾個 React 特性可以討稐。

- **組件導向**
React 凡事都採用 Componet 來製作組件，需要就可重複運用。且都主要依賴 JavaScript 來編寫，因此整體維護性質很高。
- **只有 View**
由於不是 MVC 觀念，只注重在顯示 View 這部分。因此較能輕易跟其他框架工具混合使用。
- **以 JSX 來表示 HTML**
由於 React 主要環境以 JavaScript 來編寫，輸出 HTML 元素相對麻煩些（你需要先 create Element 然後 insert 等過程）， 因此 React 建議（非絕對）可考慮使用 JSX 技術來完成這部分。JSX 是指透過標籤方式直接寫在 JavaScript 內，當 React 進行 Complier 時透過 Babel 編譯成一般的 JavaScript 語法提供給瀏覽器，Babel 是一種轉譯語言（與 TypeScript 為同類型轉譯工具），Babel 主要用途除了 JSX 這種快速編寫 HTML 的技術，另外也提供像是 JS 編譯降版相容等功能。
- **Virtual DOM 渲染**
React 不會直接操作網頁實體 DOM，而是透過自己的虛擬化 DOM 來進行渲染化。虛擬化 DOM 只會針對局部已改變的應用套在實體 DOM，這能加快效能速度。
- **Hook 功能**
在 React 16.8 版本開始使用，可以在不使用 JavaScript 的 Class（舊方法）就能方便的使用 React 功能（未來主流方向）。官方手冊目前仍是以 Class 方式來呼喚 React 功能，而 Hook 是另外篇幅介紹。本站也會另外介紹 Hook，在工作上兩套都還是要理解，看公司 React 環境是否引入 Hook 製成為主。

## 安裝
檔案可以主要有 2 筆 React 檔案，以及額外的 1 筆 Babel 檔案（如果你要用 JSX 來編寫 HTML 則需用到）。React 檔案除了主檔案`react.js`之外，還有一隻負責 Virtual DOM 的`react-dom.js`。本節的 React 語法可以看不懂先無視，主要是測試 React 安裝是否可運作。而你開始接觸 JS 框架這個程度上，你很清楚在專案上的安裝使用可以分很多方法來完成。React 不例外也分為以下方法使用：

### 透過 CDN
想直接使用可透過 CDN 來引入，提供了未壓縮（開發用）跟已壓縮兩種來源。

>使用 CDN 存取 React 建議 script 標籤屬性添加 crossorigin 確保跨網域存取能正常。
```html
<!-- 開發版 -->
<script crossorigin src="https://unpkg.com/react@17/umd/react.development.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>

<!-- 壓縮版 -->
<script crossorigin src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
```

#### 不使用 JSX 的寫法
這裡提供不想使用 Babel 來編寫 React 的寫法，事實上複雜度較高。

```html index.html
<body>
  <div id="btnLoki"></div>
  
  <!-- 開發版 -->
  <script crossorigin src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>

  <!-- 自訂 Component -->
  <script src="custom.js"></script>
</body>
```
接著在設計 component 當下，需要透過 React 來 createElement 創造 HTML 元素，以及對這個元素進行 HTML 編寫。最後透過虛擬 DOM 指定哪個元素跟組件並渲染到哪個實體 DOM。

```js custom.js
'use strict';
const btn = React.createElement; //純 React 的 HTML 元素，屆時需指定為標籤名、屬性、內容等參數

//組件 LikeButton
class LikeButton extends React.Component {
  constructor(props) {
    super(props);
    this.state = { liked: false };
  }

  render() {
    if (this.state.liked) {
      return 'You liked this.';
    }

    return btn( //提供標籤名、屬性、內容
      'button',
      { onClick: () => this.setState({ liked: true }) },
      'Like'
    );
  }
}

//實體 DOM
const domContainer = document.querySelector('#btnLoki');

//虛擬 DOM 的渲染
ReactDOM.render(btn(LikeButton), domContainer);
```

#### 使用 JSX 的寫法
如果透過 Babel 的 JSX 來設計，就會非常簡單。但要多引用 BabelJS 以及讓 Babel 知道哪個 JS 檔案需要做 JSX 轉譯。
```html index.html
<body>
  <div id="btnLoki"></div>
  
  <!-- 開發版 -->
  <script crossorigin src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>

  <!-- JSX 用 -->
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

  <!-- 告知 Babel 這裡的 JS 有 JSX 語法需要轉譯處理 -->
  <script type="text/babel" src="custom.js"></script>
</body>
```
設計組件時，就不用 React 的 createElement，直接將 JSX 寫在組件內即可。而虛擬 DOM 當下只需要直接寫組件並渲染到實體 DOM 上，因為 HTML 元素透過 JSX 直接寫在組件內。
```js custom.js
'use strict';

//建立組件 LikeButton
class LikeButton extends React.Component {
  constructor(props) {
    super(props);
    this.state = { liked: false };
  }

  render() {
    if (this.state.liked) {
      return 'You liked this.';
    }

    return (
      <button onClick={() => this.setState({ liked: true })}>
        Like
      </button>
    );
  }
}

//實體 DOM
const domContainer = document.querySelector('#btnLoki');

//虛擬 DOM 的渲染
ReactDOM.render(<LikeButton />, domContainer);
```

### 透過 CLI
所謂的 CLI 是提供一個系統輔助工具，能夠快速建立 React 開發所需要的伺服器環境與轉譯系統。React 提供了`Create React App`的 Node 工具（可稱呼為ˇReact CLI)。能無腦的解決環境應用進行開發，推薦新手學習使用。Create React App 本身僅包含了 webpack 與 babel 的前端建置管道，不提供任何後端服務功能。

1. node 環境下輸入指令進行安裝，並指定一個應用 APP 名稱建立
```shell node.js
npx create-react-app my-app
```
>npx 為 npm 5.2+ 提供的打包 CLI 工具，能確保原本該全域安裝的 node 套件被限定在該專案目錄下，如此一來就可以讓本機環境乾淨些。否則以 npm 安裝需要寫成`npm install -g create-react-app`並透過指令`create-react-app my-app`來建立應用 APP 名稱。
2. 檢查專案內會多一個 my-app 的應用目錄，以及在 package.json 內可以看到以提供 start 指令。我們將位置切換至應用 APP 位置並啟用網站服務。
```shell node.js
cd my-app
npm start
```

此時會獲得一個網站網址為`http://localhost:3000/`，並且已經存在一個 DEMO 用的專案應用網站。透過這個 DEMO 網站進行內部檔案簡單擺放說明（規則是 webpack 所規定的，當然也可異動）：
- **public:**
作為公共的檔案區，舉例看到 index.html 或圖片放置在這裡。
- **src:**
為 React 程式集中區，包含 React 會 import 的 css 也放在這，舉例看到 index.js 與 App.js 主要兩隻檔案放在這裡。
- **build:**
如果要將專案發佈到線上環境，透過`npm run build`進行建置作業，會產生該目錄（產生瀏覽器看得懂的純 HTML、JS、CSS 專案目錄）。

### 擴展開發工具
如果希望能在開發上獲得更好的檢查工具，可透過加裝 [Chrome 擴充工具](https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi?hl=en)，其他品牌瀏覽器可 [參考官方推薦](https://zh-hant.reactjs.org/docs/optimizing-performance.html#profiling-components-with-the-devtools-profiler)。

## 基本觀念
本節開始進入基本介紹 React 相關基礎知識。本篇整體將採用 CLI 方式進行練習測試，這能簡化 HTML 編寫且省去宣告 Babel 動作。練習方式請從前面介紹`Create React App`所提供的 DEMO 包開始動作， src 內部所有檔案並將練習的 React 檔案從`src/index.js`開始編寫，調整 html 請從`public/index.html`開始改寫。初始動作準備如下：

```html public/index.html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <div id="root"></div>
</body>
</html>
```

要使用 React 之前，必須先從專案目錄內匯入 React 與 ReactDOM 才能正常使用 React 與 DOM 渲染。

```js src/index.js
import React from 'react'; //必要
import ReactDOM from 'react-dom'; //必要

ReactDOM.render(
  <h1>Hello, world!</h1>,
  document.getElementById('root')
);

//render 為 透過虛擬 DOM 渲染到實體 DOM 上，這裡綁訂一個 h1 標籤給 HTML 元素 #root
```

簡單示意對 div 元素 DOM 編寫內容 h1 標籤為 hello world。

### JSX 語法
JSX 如前面已介紹，能夠在 JavaScript 內直接寫入 HTML 標籤，使得透過 Babel 偵測自動編譯成 JavaScript。例如下面寫法直接編寫。另外若需夾任何表達式都能以`{}`包覆，例如變數、運算符、帶回傳之函式等各種。

```js src/index.js
import React from 'react';
import ReactDOM from 'react-dom';

const name = 'Josh Perez';
const element = <h1>Hello, {name}</h1>; //可夾帶變數使用{}替換

ReactDOM.render(
  element,
  document.getElementById('root')
);
```

由於 JSX 屬於 JavaScript，因此在屬性上寫法採用駝峰式命名需注意大小寫。同時因為 class 為特殊關鍵字須改用 className。

```js
const element1 = <h1 className="cls" tabIndex="0">Class 名稱特別要改寫</h1>;
const element2 = <h1 tabIndex="0">一些屬性要改駝峰式寫法</h1>;
const element3 = <img src={user.img} />;
```

也能用`()`來包覆一個複合 HTML。

```js
const element = (
  <div>
    <h1>Hello!</h1>
    <h2>Good to see you here.</h2>
  </div>
);
```

### Render 渲染
React 的元素使用 JSX 來編寫形成一個物件，而瀏覽器的元素 node 是實體 DOM。如想要將元素物件塞到實體 DOM 做成 UI 畫面，就必須透過`ReactDOM.js`的特定函式`ReactDOM.render(ReactElement,DOM_NODE)`來達到渲染。這個函式本身只會執行一次，一次將所有的虛擬 DOM 需求渲染成實體 DOM，這能保證每次渲染只會更新必要的元素替換。

```html public/index.html
<body>
  <div id="root"></div>
</body>
```
```js src/index.js
import React from 'react';
import ReactDOM from 'react-dom';

const element = <h1>Hello, world</h1>;
ReactDOM.render(element, document.getElementById('root'));  //透過函式將 element 物件與 DOM 位置提交
```

每次 React 的元素物件是不可變的，如果要重複做 UI 輸出，就必須要再做一個新元素物件提交至`ReactDOM.render()`。

```js src/index.js
import React from 'react';
import ReactDOM from 'react-dom';

function tick() {
  const element = (
    <div>
      <h1>Hello, world!</h1>
      <h2>It is {new Date().toLocaleTimeString()}.</h2>
    </div>
  );
  ReactDOM.render(element, document.getElementById('root'));
}

setInterval(tick, 1000); //透過 function 不斷要求提供新的 html 塞到指定 UI
```
### Componet 組件
由於 React 採用組件導向的框架，設計方式就是先建立組件接著利用組件來顯示頁面結果。定義組件的作法基礎方法就是純 JavaScript 函式，而 React 的組件是採 ES6 的 class 來定義（透過繼承 React.Componet)。

```js
//function componet
function Welcome(props) {
  return <h1>Hello, {props.name}</h1>;
}

//class componet
class Welcome extends React.Component {
  render() { //表達此 class 組件要呈現的內容
    return <h1>Hello, {this.props.name}</h1>;
  }
}
```

以上的 function componet 與 class componet 是相同效果的，而參數 props 為傳遞資料可做額外的資訊輸出組合。

#### 渲染輸出

# 參考文獻
